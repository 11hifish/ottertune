<!DOCTYPE html>
<html>
<script type="text/javascript" src="{{ STATIC_URL }} /static/jquery-1.10.2.min.js"></script>
<head>
    <title>Home</title>
</head>
<body>

<div id="account_info">
<p>Hi, {{ username }} (<a href="/logout">logout</a>)</p>
<p>Your upload code is: {{ upload_code }}</p>
<form action="/get_new_upload_code/" method="POST"
      onsubmit="return confirm('This operation will revoke the current code, are you sure to continue?')"> {% csrf_token %}
    <button type="submit">Get a new upload code</button>
</form>
</div>

<hr>

<div id="project_list">
<form action="/delete_project/" method="POST"
      onsubmit="return confirm('Are you sure you want to delete these projects and all targets/results under this project?')">
      {% csrf_token %}
<p>Your projects:</p>
<table id="project_table" border="1">
    <tr>
        <th><input type="checkbox" onClick="toggle(this, 'projects')" /></th>
        <th>Project Name</th>
        <th>Description</th>
        <th>Last Update</th>
        <th>Creation Time</th>
    </tr>
    {% for project in projects %}
        <tr>
            <td><input type="checkbox" name="projects" value="{{ project.pk }}" /></td>
            <td><a href="/project/?id={{project.pk}}">{{ project.name }}</a></td>
            <td><pre>{{ project.description }}</pre></td>
            <td>{{ project.creation_time }}</td>
            <td>{{ project.last_update }}</td>
        </tr>
    {% endfor %}
</table>
<button type="submit">Delete selected projects</button>
</form>
</div>

<div id="new_project_form">
<form action="/new_project/" method="POST"> {% csrf_token %}
    <p>Create a new project:</p>
    <table border="0">
        <tr>
            <td><label>Name:</label></td>
            <td><input type="text" name="name" value="" maxlength="50" required/></td>
        </tr>
        <tr>
            <td><label>Description:</label></td>
            <td><textarea cols="40" rows="5" name="description" maxlength="500" required></textarea></td>
        </tr>
    </table>

    <button type="submit">Add new project</button>
</form>
</div>

<hr>

<div id="env_list">
<form action="/delete_env/" method="POST"
      onsubmit="return confirm('Are you sure you want to delete these environments and all results generated from them?')">
      {% csrf_token %}
<p>Your environments:</p>
<table id="env_table" border="1">
    <tr>
        <th><input type="checkbox" onClick="toggle(this, 'environments')" /></th>
        <th>Environment Name</th>
        <th>Description</th>
        <th>Creation Time</th>
    </tr>
    {% for env in environments %}
        <tr>
            <td><input type="checkbox" name="environments" value="{{ env.pk }}" /></td>
            <td><a href="/environment?id={{env.pk}}">{{ env.name }}</a></td>
            <td><pre>{{ env.description }}</pre></td>
            <td>{{ env.creation_time }}</td>
        </tr>
    {% endfor %}
</table>
<button type="submit">Delete selected environments</button>
</form>
</div>

<div id="new_env_form">
<form action="/new_env/" method="POST"> {% csrf_token %}
    <p>Create a new environment:</p>
    <table border="0">
        <tr>
            <td><label>Name:</label></td>
            <td><input type="text" name="name" value="" maxlength="50" required/></td>
        </tr>
        <tr>
            <td><label>Description:</label></td>
            <td><textarea cols="40" rows="5" name="description" maxlength="500" required></textarea></td>
        </tr>
    </table>

    <button type="submit">Add new environment</button>
</form>
</div>

<script type="text/javascript">
function toggle(source, name) {
    checkboxes = document.getElementsByName(name);
    for(var i=0, n=checkboxes.length; i<n; i++) {
        checkboxes[i].checked = source.checked;
    }
}
</script>

</body>
</html>
